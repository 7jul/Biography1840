<!DOCTYPE html>
<html lang="zh-CN">
<head>
    <meta charset="UTF-8">
    <meta name="viewport" content="width=device-width, initial-scale=1.0">
    <title>è¿‘ä»£äººç‰©ä¼ è®°</title>
    <style>
        :root {
            --primary-color: #e94560;
            --bg-color: #1a1a2e;
            --sidebar-bg: rgba(22, 33, 62, 0.95);
            --text-color: #e0e0e0;
            --border-color: rgba(233, 69, 96, 0.2);
            --shadow-color: rgba(0, 0, 0, 0.3);
        }

        .theme-light {
            --bg-color: #f5f5f5;
            --sidebar-bg: #ffffff;
            --text-color: #333333;
            --border-color: #ddd;
            --shadow-color: rgba(0, 0, 0, 0.1);
        }

        .theme-sepia {
            --bg-color: #f4ecd8;
            --sidebar-bg: #fdf6e3;
            --text-color: #5c4b37;
            --border-color: #d4c4a8;
            --shadow-color: rgba(92, 75, 55, 0.1);
        }

        .theme-green {
            --bg-color: #1a2f1a;
            --sidebar-bg: rgba(26, 47, 26, 0.95);
            --text-color: #c8d8c8;
            --border-color: rgba(76, 175, 80, 0.3);
            --shadow-color: rgba(0, 0, 0, 0.3);
        }

        * {
            margin: 0;
            padding: 0;
            box-sizing: border-box;
        }

        body {
            font-family: "Microsoft YaHei", "å¾®è½¯é›…é»‘", "PingFang SC", sans-serif;
            background: var(--bg-color);
            color: var(--text-color);
            min-height: 100vh;
            transition: all 0.3s ease;
        }

        .container {
            display: flex;
            height: 100vh;
        }

        /* å·¦ä¾§ç›®å½•æ  */
        .sidebar {
            width: 350px;
            background: var(--sidebar-bg);
            border-right: 1px solid var(--border-color);
            display: flex;
            flex-direction: column;
            box-shadow: 2px 0 20px var(--shadow-color);
            z-index: 100;
        }

        .sidebar-header {
            padding: 20px;
            border-bottom: 1px solid var(--border-color);
            background: linear-gradient(90deg, rgba(233, 69, 96, 0.1) 0%, transparent 100%);
        }

        .sidebar-header h1 {
            font-size: 20px;
            color: var(--primary-color);
            margin-bottom: 15px;
            display: flex;
            align-items: center;
            gap: 10px;
        }

        .sidebar-header h1::before {
            content: 'ğŸ“š';
        }

        /* æœç´¢æ¡† */
        .search-box {
            display: flex;
            gap: 8px;
        }

        .search-input {
            flex: 1;
            padding: 10px 15px;
            border: 1px solid var(--border-color);
            border-radius: 8px;
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-color);
            font-size: 14px;
            transition: all 0.3s ease;
        }

        .search-input:focus {
            outline: none;
            border-color: var(--primary-color);
            box-shadow: 0 0 10px rgba(233, 69, 96, 0.2);
        }

        /* ç­›é€‰å·¥å…·æ  */
        .toolbar {
            padding: 15px 20px;
            border-bottom: 1px solid var(--border-color);
            display: flex;
            flex-wrap: wrap;
            gap: 10px;
            align-items: center;
        }

        .filter-group {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .filter-label {
            font-size: 12px;
            color: var(--text-color);
            opacity: 0.7;
        }

        .filter-select, .sort-select {
            padding: 6px 12px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-color);
            font-size: 12px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .filter-select:hover, .sort-select:hover {
            border-color: var(--primary-color);
        }

        .stats-info {
            font-size: 12px;
            color: var(--text-color);
            opacity: 0.7;
            margin-left: auto;
        }

        /* ç›®å½•åˆ—è¡¨ */
        .catalog {
            flex: 1;
            overflow-y: auto;
            padding: 15px;
        }

        .catalog::-webkit-scrollbar {
            width: 6px;
        }

        .catalog::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .catalog::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 3px;
        }

        .catalog-item {
            padding: 12px 15px;
            background: rgba(255, 255, 255, 0.02);
            border: 1px solid var(--border-color);
            border-radius: 8px;
            margin-bottom: 8px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            flex-direction: column;
            gap: 8px;
        }

        .catalog-item:hover {
            background: rgba(233, 69, 96, 0.1);
            border-color: var(--primary-color);
            transform: translateX(5px);
        }

        .catalog-item.active {
            background: linear-gradient(135deg, rgba(233, 69, 96, 0.2) 0%, rgba(233, 69, 96, 0.1) 100%);
            border-color: var(--primary-color);
        }

        .catalog-item .header {
            display: flex;
            justify-content: space-between;
            align-items: center;
        }

        .catalog-item .name {
            font-size: 15px;
            font-weight: 600;
            color: var(--text-color);
        }

        .catalog-item .meta {
            display: flex;
            gap: 8px;
            font-size: 11px;
            color: var(--text-color);
            opacity: 0.7;
        }

        .catalog-item .country-tag {
            padding: 2px 8px;
            background: rgba(233, 69, 96, 0.15);
            color: var(--primary-color);
            border-radius: 12px;
            font-size: 10px;
        }

        .catalog-item .brief {
            font-size: 12px;
            color: var(--text-color);
            opacity: 0.8;
            line-height: 1.4;
            overflow: hidden;
            text-overflow: ellipsis;
            display: -webkit-box;
            -webkit-line-clamp: 2;
            -webkit-box-orient: vertical;
        }

        /* å³ä¾§å†…å®¹åŒº */
        .main-content {
            flex: 1;
            display: flex;
            flex-direction: column;
            overflow: hidden;
        }

        /* é¡¶éƒ¨å·¥å…·æ  */
        .content-toolbar {
            padding: 15px 25px;
            background: var(--sidebar-bg);
            border-bottom: 1px solid var(--border-color);
            display: flex;
            justify-content: space-between;
            align-items: center;
            box-shadow: 0 2px 10px var(--shadow-color);
        }

        .doc-title {
            font-size: 18px;
            font-weight: 600;
            color: var(--primary-color);
        }

        .toolbar-group {
            display: flex;
            gap: 15px;
            align-items: center;
        }

        /* å­—å·æ§åˆ¶ */
        .font-control {
            display: flex;
            align-items: center;
            gap: 8px;
        }

        .font-btn {
            width: 32px;
            height: 32px;
            border: 1px solid var(--border-color);
            border-radius: 6px;
            background: rgba(255, 255, 255, 0.05);
            color: var(--text-color);
            font-size: 16px;
            cursor: pointer;
            transition: all 0.3s ease;
            display: flex;
            align-items: center;
            justify-content: center;
        }

        .font-btn:hover {
            background: rgba(233, 69, 96, 0.2);
            border-color: var(--primary-color);
        }

        .font-size-display {
            font-size: 14px;
            color: var(--text-color);
            min-width: 50px;
            text-align: center;
        }

        /* ä¸»é¢˜åˆ‡æ¢ */
        .theme-switch {
            display: flex;
            gap: 8px;
        }

        .theme-btn {
            width: 32px;
            height: 32px;
            border: 2px solid var(--border-color);
            border-radius: 6px;
            cursor: pointer;
            transition: all 0.3s ease;
        }

        .theme-btn.active {
            border-color: var(--primary-color);
            transform: scale(1.1);
        }

        .theme-btn.default {
            background: linear-gradient(135deg, #1a1a2e 50%, #e94560 50%);
        }

        .theme-btn.light {
            background: #f5f5f5;
        }

        .theme-btn.sepia {
            background: #f4ecd8;
        }

        .theme-btn.green {
            background: #1a2f1a;
        }

        /* é˜…è¯»åŒºåŸŸ */
        .reader-area {
            flex: 1;
            overflow-y: auto;
            padding: 30px 50px;
        }

        .reader-area::-webkit-scrollbar {
            width: 8px;
        }

        .reader-area::-webkit-scrollbar-track {
            background: rgba(255, 255, 255, 0.05);
        }

        .reader-area::-webkit-scrollbar-thumb {
            background: var(--primary-color);
            border-radius: 4px;
        }

        /* Markdownå†…å®¹æ ·å¼ */
        .markdown-content {
            max-width: 800px;
            margin: 0 auto;
            line-height: 1.8;
            transition: all 0.3s ease;
        }

        .markdown-content h1 {
            font-size: 2em;
            color: var(--primary-color);
            margin-bottom: 20px;
            padding-bottom: 15px;
            border-bottom: 2px solid var(--border-color);
            text-align: center;
        }

        .markdown-content h2 {
            font-size: 1.5em;
            color: var(--primary-color);
            margin: 30px 0 15px 0;
            padding-bottom: 10px;
            border-bottom: 1px solid var(--border-color);
        }

        .markdown-content h3 {
            font-size: 1.25em;
            color: var(--text-color);
            margin: 25px 0 10px 0;
            padding-left: 15px;
            border-left: 3px solid var(--primary-color);
        }

        .markdown-content p {
            margin: 15px 0;
            text-align: justify;
            text-indent: 2em;
        }

        .markdown-content hr {
            border: none;
            border-top: 2px dashed var(--border-color);
            margin: 30px 0;
        }

        .markdown-content ul, .markdown-content ol {
            margin: 15px 0;
            padding-left: 30px;
        }

        .markdown-content li {
            margin: 8px 0;
        }

        .markdown-content blockquote {
            margin: 20px 0;
            padding: 15px 20px;
            background: rgba(233, 69, 96, 0.1);
            border-left: 4px solid var(--primary-color);
            border-radius: 0 8px 8px 0;
        }

        .markdown-content code {
            background: rgba(233, 69, 96, 0.1);
            padding: 2px 6px;
            border-radius: 4px;
            font-family: "Consolas", "Monaco", monospace;
            font-size: 0.9em;
        }

        .markdown-content pre {
            background: rgba(0, 0, 0, 0.2);
            padding: 20px;
            border-radius: 8px;
            overflow-x: auto;
            margin: 20px 0;
        }

        .markdown-content pre code {
            background: none;
            padding: 0;
        }

        .markdown-content table {
            width: 100%;
            border-collapse: collapse;
            margin: 20px 0;
        }

        .markdown-content th, .markdown-content td {
            border: 1px solid var(--border-color);
            padding: 12px;
            text-align: left;
        }

        .markdown-content th {
            background: rgba(233, 69, 96, 0.1);
            color: var(--primary-color);
        }

        /* æ¬¢è¿é¡µé¢ */
        .welcome-page {
            text-align: center;
            padding: 100px 50px;
        }

        .welcome-page h2 {
            font-size: 28px;
            color: var(--primary-color);
            margin-bottom: 20px;
        }

        .welcome-page p {
            font-size: 16px;
            color: var(--text-color);
            opacity: 0.7;
            line-height: 1.8;
        }

        .welcome-icon {
            font-size: 64px;
            margin-bottom: 30px;
        }

        /* åˆ†ç±»æ ‡ç­¾ */
        .category-tag {
            display: inline-block;
            padding: 4px 10px;
            background: rgba(233, 69, 96, 0.15);
            color: var(--primary-color);
            border-radius: 15px;
            font-size: 11px;
            margin-right: 5px;
        }

        /* å“åº”å¼è®¾è®¡ */
        @media (max-width: 1024px) {
            .sidebar {
                width: 300px;
            }

            .reader-area {
                padding: 25px 35px;
            }
        }

        @media (max-width: 768px) {
            .container {
                flex-direction: column;
            }

            .sidebar {
                width: 100%;
                height: 40vh;
            }

            .main-content {
                height: 60vh;
            }

            .reader-area {
                padding: 20px 25px;
            }
        }

        /* åŠ¨ç”» */
        @keyframes fadeIn {
            from {
                opacity: 0;
                transform: translateY(20px);
            }
            to {
                opacity: 1;
                transform: translateY(0);
            }
        }

        .fade-in {
            animation: fadeIn 0.5s ease forwards;
        }

        /* åŠ è½½åŠ¨ç”» */
        .loading {
            display: flex;
            justify-content: center;
            align-items: center;
            padding: 50px;
        }

        .loading-spinner {
            width: 40px;
            height: 40px;
            border: 3px solid var(--border-color);
            border-top-color: var(--primary-color);
            border-radius: 50%;
            animation: spin 1s linear infinite;
        }

        @keyframes spin {
            to {
                transform: rotate(360deg);
            }
        }

        /* åˆ†ç»„æ ‡é¢˜ */
        .group-title {
            font-size: 12px;
            color: var(--text-color);
            opacity: 0.6;
            padding: 10px 15px 5px;
            margin-top: 10px;
            border-bottom: 1px solid var(--border-color);
        }
    </style>
</head>
<body>
    <div class="container">
        <!-- å·¦ä¾§ç›®å½•æ  -->
        <aside class="sidebar">
            <div class="sidebar-header">
                <h1>è¿‘ä»£äººç‰©ä¼ è®°</h1>
                <div class="search-box">
                    <input type="text" class="search-input" id="search-input" placeholder="ğŸ” æœç´¢äººç‰©å§“å...">
                </div>
            </div>

            <div class="toolbar">
                <div class="filter-group">
                    <span class="filter-label">å›½åˆ«:</span>
                    <select class="filter-select" id="country-filter">
                        <option value="all">å…¨éƒ¨</option>
                        <option value="ä¸­å›½">ğŸ‡¨ğŸ‡³ ä¸­å›½</option>
                        <option value="æ—¥æœ¬">ğŸ‡¯ğŸ‡µ æ—¥æœ¬</option>
                        <option value="è‹±å›½">ğŸ‡¬ğŸ‡§ è‹±å›½</option>
                        <option value="ç¾å›½">ğŸ‡ºğŸ‡¸ ç¾å›½</option>
                        <option value="å¾·å›½">ğŸ‡©ğŸ‡ª å¾·å›½</option>
                        <option value="æ¾³å¤§åˆ©äºš">ğŸ‡¦ğŸ‡º æ¾³å¤§åˆ©äºš</option>
                        <option value="çˆ±å°”å…°">ğŸ‡®ğŸ‡ª çˆ±å°”å…°</option>
                        <option value="å·´æ ¼è¾¾çŠ¹å¤ª">ğŸ›ï¸ å·´æ ¼è¾¾çŠ¹å¤ª</option>
                    </select>
                </div>

                <div class="filter-group">
                    <span class="filter-label">æ’åº:</span>
                    <select class="sort-select" id="sort-select">
                        <option value="name">æŒ‰å§“å</option>
                        <option value="birth">æŒ‰å‡ºç”Ÿå¹´</option>
                        <option value="country">æŒ‰å›½åˆ«</option>
                    </select>
                </div>

                <span class="stats-info" id="stats-info">å…± 0 äºº</span>
            </div>

            <div class="catalog" id="catalog">
                <!-- ç›®å½•é¡¹å°†é€šè¿‡JSåŠ¨æ€ç”Ÿæˆ -->
            </div>
        </aside>

        <!-- å³ä¾§å†…å®¹åŒº -->
        <main class="main-content">
            <!-- é¡¶éƒ¨å·¥å…·æ  -->
            <div class="content-toolbar">
                <div class="doc-title" id="doc-title">ğŸ“– è¿‘ä»£äººç‰©ä¼ è®°</div>
                <div class="toolbar-group">
                    <!-- å­—å·æ§åˆ¶ -->
                    <div class="font-control">
                        <button class="font-btn" id="font-decrease" title="ç¼©å°å­—å·">A-</button>
                        <span class="font-size-display" id="font-size-display">18px</span>
                        <button class="font-btn" id="font-increase" title="æ”¾å¤§å­—å·">A+</button>
                        <button class="font-btn" id="font-reset" title="é‡ç½®å­—å·">â†º</button>
                    </div>

                    <!-- ä¸»é¢˜åˆ‡æ¢ -->
                    <div class="theme-switch">
                        <button class="theme-btn default active" data-theme="default" title="é»˜è®¤æ·±è‰²"></button>
                        <button class="theme-btn light" data-theme="light" title="æµ…è‰²æ¨¡å¼"></button>
                        <button class="theme-btn sepia" data-theme="sepia" title="æŠ¤çœ¼æ¨¡å¼"></button>
                        <button class="theme-btn green" data-theme="green" title="æ·±ç»¿æ¨¡å¼"></button>
                    </div>
                </div>
            </div>

            <!-- é˜…è¯»åŒºåŸŸ -->
            <div class="reader-area" id="reader-area">
                <div class="welcome-page" id="welcome-page">
                    <div class="welcome-icon">ğŸ“š</div>
                    <h2>è¿‘ä»£äººç‰©ä¼ è®°</h2>
                    <p>
                    æ¬¢è¿é˜…è¯»è¿‘ä»£äººç‰©ä¼ è®°<br>
                    å£°æ˜ï¼šæœ¬ç½‘ç«™ç”±Openclawè‡ªåŠ¨ç»´æŠ¤ï¼Œä¸ä¿è¯äººç‰©ä¿¡æ¯çš„å‡†ç¡®æ€§ã€‚<br>
                    æ–‡å­—å‡ç”±AIæœç´¢èµ„æ–™å¹¶ç”Ÿæˆï¼Œä¸å¾—ç”¨åšå­¦æœ¯å¼•ç”¨ã€‚<br>
                    å¦‚æœ‰æ˜æ˜¾é”™è¯¯ï¼Œå¯é€šè¿‡è”ç³»ä½œè€…ï¼š<br>
                    ä¸ƒæœˆ:<a href="mailto:yyuttao@Hotmail.com">yyuttao@Hotmail.com</a>è¿›è¡Œä¿®æ­£<br>
                    </p>
                    <p>
                        ä½¿ç”¨æ–¹æ³•<br>
                        è¯·ä»å·¦ä¾§ç›®å½•é€‰æ‹©ä¸€ä½äººç‰©å¼€å§‹é˜…è¯»<br>
                        æ‚¨å¯ä»¥æœç´¢ã€ç­›é€‰ã€æ’åºæ¥æ‰¾åˆ°æ„Ÿå…´è¶£çš„äººç‰©<br><br>
                        ğŸ’¡ æç¤ºï¼šä½¿ç”¨é¡¶éƒ¨å·¥å…·æ è°ƒæ•´é˜…è¯»ç•Œé¢
                    </p>
                </div>
                <div class="markdown-content" id="markdown-content" style="display: none;"></div>
            </div>
        </main>
    </div>

    <script>
        // äººç‰©æ•°æ®ï¼ˆä»JSONæ–‡ä»¶åŠ è½½ï¼‰
        let peopleData = [];
        let mdFiles = new Map(); // æ–‡ä»¶åæ˜ å°„
        let currentDoc = null;
        let currentFontSize = 18;

        // åˆå§‹åŒ–
        document.addEventListener('DOMContentLoaded', async function() {
            await loadPeopleData();
            await scanMdFiles();
            buildCatalog();
            bindEvents();
        });

        // åŠ è½½äººç‰©æ•°æ®
        async function loadPeopleData() {
            try {
                const response = await fetch('data/people.min.json');
                const data = await response.json();
                peopleData = data.data;
                updateStats();
            } catch (error) {
                console.error('åŠ è½½äººç‰©æ•°æ®å¤±è´¥:', error);
            }
        }

        // æ‰«æmdç›®å½•ä¸­çš„æ–‡ä»¶ï¼ˆåŸºäºdataæ•°æ®ï¼‰
        async function scanMdFiles() {
            // å¤–å›½äººç‰©çš„æ–‡ä»¶åæ ¼å¼ï¼šå¤§å¤šæ•°ä¸º ä¸­æ–‡å_è‹±æ–‡å.md
            const foreignNameMap = {
                'åˆ©é¡ºå¾·': 'åˆ©é¡ºå¾·_Alexander_Stuart.md',
                'èµ«å¾·': 'èµ«å¾·_Robert_Hart.md',
                'å…‹æ—å¾·': 'å…‹æ—å¾·_Baron_von_der_Goltz.md',
                'ä¼Šè—¤åšæ–‡': 'ä¼Šè—¤åšæ–‡_Ito_Hirobumi.md',
                'è«ç†å¾ª': 'è«ç†å¾ª_George_Morrison.md',
                'è¨é“ä¹‰': 'è¨é“ä¹‰_Ernest_Satow.md',
                'å˜‰é“ç†': 'å˜‰é“ç†_Ellis_Kadoorie.md',
                'ç«¯çº³': 'ç«¯çº³_William_Henry_Donald.md',
                'èµ«ç«‹å¾·': 'èµ«ç«‹å¾·_Thomas_Helliwell.md',
                'é©¬æµ·å¾·': 'é©¬æµ·å¾·_George_Hatem.md',
                'åˆ˜æµ·æ¾œ': 'åˆ˜æµ·æ¾œ_Hiram_Harrison_Lowry.md'
            };

            peopleData.forEach(person => {
                if (foreignNameMap[person.n]) {
                    // å¤–å›½äººç‰©ä½¿ç”¨ç‰¹æ®Šæ–‡ä»¶åæ ¼å¼
                    mdFiles.set(person.n, `md/${foreignNameMap[person.n]}`);
                } else {
                    // ä¸­å›½äººç‰©ç›´æ¥ä½¿ç”¨ "å§“åä¼ .md" æ ¼å¼
                    mdFiles.set(person.n, `md/${person.n}ä¼ .md`);
                }
            });
        }

        // æ„å»ºç›®å½•ï¼ˆä½¿ç”¨dataæ•°æ®ï¼‰
        function buildCatalog(filteredData = null) {
            const data = filteredData || peopleData;
            const catalog = document.getElementById('catalog');
            catalog.innerHTML = '';

            // æŒ‰é¦–å­—æ¯åˆ†ç»„
            const grouped = {};
            data.forEach(person => {
                const letter = getFirstLetter(person.n);
                if (!grouped[letter]) {
                    grouped[letter] = [];
                }
                grouped[letter].push(person);
            });

            // ç”Ÿæˆç›®å½•
            Object.keys(grouped).sort().forEach(letter => {
                const groupTitle = document.createElement('div');
                groupTitle.className = 'group-title';
                groupTitle.textContent = `â–£ ${letter}`;
                catalog.appendChild(groupTitle);

                grouped[letter].forEach(person => {
                    const item = createCatalogItem(person);
                    catalog.appendChild(item);
                });
            });
        }

        // è·å–é¦–å­—æ¯ï¼ˆæ”¯æŒä¸­è‹±æ–‡ï¼‰
        function getFirstLetter(name) {
            const foreignNameMap = {
                'ä¸å®¶ç«‹': 'D', 'åˆ©é¡ºå¾·': 'L', 'èµ«å¾·': 'H', 'å…‹æ—å¾·': 'K',
                'ä¼Šè—¤åšæ–‡': 'I', 'å·å²›æµªé€Ÿ': 'C', 'è«ç†å¾ª': 'M', 'è¨é“ä¹‰': 'S',
                'å˜‰é“ç†': 'J', 'ç«¯çº³': 'D', 'èµ«ç«‹å¾·': 'H', 'é©¬æµ·å¾·': 'M',
                'è´¹æ­£æ¸…': 'F', 'å¸å¾’é›·ç™»': 'S', 'åˆ˜æµ·æ¾œ': 'L', 'å¾·ç’€ç³': 'D',
                'ç“¦å¾·è¥¿': 'W', 'ææ³°å›½': 'L'
            };
            
            if (foreignNameMap[name]) {
                return foreignNameMap[name];
            }
            
            // ä¸­æ–‡å­—ç¬¦æ‹¼éŸ³é¦–å­—æ¯æ˜ å°„
            const pinyinMap = {
                'å‘¨': 'Z', 'æ': 'L', 'è¢': 'Y', 'å¼ ': 'Z', 'æ¢': 'L',
                'é»„': 'H', 'è”¡': 'C', 'ä¸¥': 'Y', 'è’‹': 'J', 'å†¯': 'F',
                'å®‹': 'S', 'å­”': 'K', 'æ®µ': 'D', 'é»': 'L', 'å¾': 'X',
                'æ›¹': 'C', 'å´': 'W', 'å­™': 'S', 'ç››': 'S', 'è£': 'R',
                'èŒƒ': 'F', 'ä¾¯': 'H', 'æ¢…': 'M', 'å°š': 'S', 'è€': 'X',
                'é©¬': 'M', 'æ±ª': 'W', 'éœ': 'H', 'è‚': 'N', 'å‰': 'J',
                'é­': 'W', 'å­Ÿ': 'M', 'å': 'H', 'ç‹': 'W', 'æœ±': 'Z',
                'èƒ¡': 'H', 'æº¥': 'P', 'ä½•': 'H', 'é‚“': 'D', 'é™ˆ': 'C',
                'æ—': 'L', 'ç™½': 'B', 'äº': 'Y', 'å®‰': 'A', 'æ›²': 'Q',
                'é«˜': 'G', 'æ¸©': 'W', 'æ¨': 'Y', 'ä¸': 'D', 'èµµ': 'Z',
                'æ–¹': 'F', 'é³': 'J', 'é²': 'B', 'å¢': 'L', 'é½': 'Q',
                'æœ': 'D', 'ç”°': 'T', 'é™†': 'L', 'é¢œ': 'Y', 'è«': 'Y',
                'é“': 'T', 'è½½': 'Z', 'å¥•': 'Y', 'ç«¯': 'D', 'åˆ˜': 'L',
                'æ²ˆ': 'S', 'é™¶': 'T', 'å¶': 'Y', 'ç« ': 'Z', 'ç§¦': 'Q',
                'çŸ³': 'S', 'ç¨‹': 'C', 'è°¢': 'X', 'å”': 'T', 'è°­': 'T',
                'æ¬§': 'O', 'é›·': 'L', 'è´º': 'H', 'é¡¾': 'G', 'åº·': 'K',
                'æ­¦': 'W', 'é‚µ': 'S', 'ä½™': 'Y', 'æ½˜': 'P', 'æœ': 'D',
                'è‹': 'S', 'é‚¹': 'Z', 'å·«': 'W', 'ç‰›': 'N', 'è’²': 'P',
                'ç‡•': 'Y', 'éƒ‘': 'Z', 'ç®¡': 'G', 'å¢': 'L', 'è«': 'M',
                'æ±Ÿ': 'J', 'å†¯': 'F', 'éŸ¦': 'W', 'æ˜Œ': 'C', 'å§š': 'Y',
                'å‚…': 'F', 'é’Ÿ': 'Z', 'ç†Š': 'X', 'ç§‹': 'Q', 'ç¦¹': 'Y',
                'ç±³': 'M', 'éº¦': 'M', 'å¸¸': 'C', 'æ­¦': 'W', 'ä¹”': 'Q',
                'è´º': 'H', 'èµ–': 'L', 'æ–‡': 'W', 'é²': 'L', 'å»–': 'L',
                'éª†': 'L', 'é¾š': 'G', 'æ¨Š': 'F', 'å…°': 'L', 'å…°': 'L',
                'å‡Œ': 'L', 'éœ': 'H', 'è™': 'Y', 'æ”¯': 'Z', 'æŸ¯': 'K',
                'ç®¡': 'G', 'å¢': 'L', 'è«': 'M', 'æˆ¿': 'F', 'è£˜': 'Q',
                'ç¼ª': 'M', 'è§£': 'X', 'åº”': 'Y', 'å®—': 'Z', 'ä¸': 'D',
                'å®£': 'X', 'é‚“': 'D', 'å•': 'S', 'æ­': 'H', 'æ´ª': 'H',
                'åŒ…': 'B', 'è¯¸': 'Z', 'å·¦': 'Z', 'çŸ³': 'S', 'å´”': 'C',
                'å‰': 'J', 'é’®': 'N', 'é¾š': 'G', 'ç¨‹': 'C', 'åµ‡': 'J',
                'é‚¢': 'X', 'è£´': 'P', 'é™†': 'L', 'è£': 'R', 'ç¿': 'W',
                'è€': 'X', 'ç¾Š': 'Y', 'æ–¼': 'Y', 'ç”„': 'Z', 'é­': 'W',
                'åŠ ': 'J', 'å¸': 'S', 'éŸ¶': 'S', 'é™ˆ': 'C', 'æˆ´': 'D'
            };
            
            const firstChar = name.charAt(0);
            return pinyinMap[firstChar] || firstChar;
        }

        // åˆ›å»ºç›®å½•é¡¹
        function createCatalogItem(person) {
            const item = document.createElement('div');
            item.className = 'catalog-item';
            
            // è·å–æ­£ç¡®çš„æ–‡ä»¶å
            const fileName = mdFiles.get(person.n) || `md/${person.n}ä¼ .md`;
            item.dataset.file = fileName;
            
            item.innerHTML = `
                <div class="header">
                    <div class="name">${person.n}</div>
                    <div class="meta">
                        <span class="country-tag">${person.c}</span>
                        <span>${person.b}-${person.d}</span>
                    </div>
                </div>
                <div class="brief">${person.i}</div>
            `;
            item.addEventListener('click', () => loadDocument(item));
            return item;
        }

        // åŠ è½½æ–‡æ¡£
        async function loadDocument(item) {
            // æ›´æ–°æ¿€æ´»çŠ¶æ€
            document.querySelectorAll('.catalog-item').forEach(i => i.classList.remove('active'));
            item.classList.add('active');

            // æ˜¾ç¤ºåŠ è½½åŠ¨ç”»
            document.getElementById('welcome-page').style.display = 'none';
            const contentArea = document.getElementById('markdown-content');
            contentArea.style.display = 'block';
            contentArea.innerHTML = '<div class="loading"><div class="loading-spinner"></div></div>';
            contentArea.classList.add('fade-in');

            // è·å–æ–‡ä»¶å
            const fileName = item.dataset.file;
            const personName = item.querySelector('.name').textContent;
            document.getElementById('doc-title').textContent = `ğŸ“– ${personName}`;

            try {
                const response = await fetch(fileName);
                if (!response.ok) {
                    throw new Error('æ–‡æ¡£åŠ è½½å¤±è´¥');
                }
                const text = await response.text();
                const html = convertMarkdown(text);
                contentArea.innerHTML = html;
                contentArea.classList.add('fade-in');
                currentDoc = fileName;

                // æ»šåŠ¨åˆ°é¡¶éƒ¨
                contentArea.scrollTop = 0;
            } catch (error) {
                contentArea.innerHTML = `
                    <div style="text-align: center; padding: 50px;">
                        <h2 style="color: var(--primary-color);">æ–‡æ¡£åŠ è½½å¤±è´¥</h2>
                        <p>${error.message}</p>
                        <p style="margin-top: 20px; opacity: 0.7;">æ–‡ä»¶è·¯å¾„: ${fileName}</p>
                    </div>
                `;
            }
        }

        // Markdownè½¬HTML
        function convertMarkdown(text) {
            let html = text
                // æ ‡é¢˜
                .replace(/^# (.+)$/gm, '<h1>$1</h1>')
                .replace(/^## (.+)$/gm, '<h2>$1</h2>')
                .replace(/^### (.+)$/gm, '<h3>$1</h3>')
                // åˆ†å‰²çº¿
                .replace(/^---$/gm, '<hr>')
                // æ®µè½
                .replace(/\n\n/g, '</p><p>')
                .replace(/^(.+)$/gm, '<p>$1</p>')
                // æ¸…é™¤å¤šä½™çš„pæ ‡ç­¾
                .replace(/<p><\/p>/g, '')
                .replace(/<p>(<h[1-6]>)/g, '$1')
                .replace(/(<\/h[1-6]>)<\/p>/g, '$1')
                .replace(/(<hr>)<\/p>/g, '$1');

            return html;
        }

        // ç»‘å®šäº‹ä»¶
        function bindEvents() {
            // æœç´¢
            document.getElementById('search-input').addEventListener('input', handleSearch);

            // ç­›é€‰
            document.getElementById('country-filter').addEventListener('change', handleFilter);

            // æ’åº
            document.getElementById('sort-select').addEventListener('change', handleSort);

            // å­—å·æ§åˆ¶
            document.getElementById('font-increase').addEventListener('click', () => adjustFontSize(2));
            document.getElementById('font-decrease').addEventListener('click', () => adjustFontSize(-2));
            document.getElementById('font-reset').addEventListener('click', resetFontSize);

            // ä¸»é¢˜åˆ‡æ¢
            document.querySelectorAll('.theme-btn').forEach(btn => {
                btn.addEventListener('click', () => {
                    document.querySelectorAll('.theme-btn').forEach(b => b.classList.remove('active'));
                    btn.classList.add('active');
                    document.body.className = `theme-${btn.dataset.theme}`;
                });
            });
        }

        // å¤„ç†æœç´¢
        function handleSearch(e) {
            const query = e.target.value.trim().toLowerCase();
            if (!query) {
                buildCatalog();
                return;
            }

            const filtered = peopleData.filter(person =>
                person.n.toLowerCase().includes(query) ||
                person.i.toLowerCase().includes(query)
            );
            buildCatalog(filtered);
            updateStats(filtered.length);
        }

        // å¤„ç†ç­›é€‰
        function handleFilter(e) {
            const country = e.target.value;
            if (country === 'all') {
                buildCatalog();
                updateStats();
            } else {
                const filtered = peopleData.filter(person => person.c === country);
                buildCatalog(filtered);
                updateStats(filtered.length);
            }
        }

        // å¤„ç†æ’åº
        function handleSort(e) {
            const sortBy = e.target.value;
            let sorted = [...peopleData];

            switch (sortBy) {
                case 'name':
                    sorted.sort((a, b) => a.n.localeCompare(b.n, 'zh-CN'));
                    break;
                case 'birth':
                    sorted.sort((a, b) => a.b - b.b);
                    break;
                case 'country':
                    sorted.sort((a, b) => a.c.localeCompare(b.c, 'zh-CN'));
                    break;
            }

            buildCatalog(sorted);
        }

        // è°ƒæ•´å­—å·
        function adjustFontSize(delta) {
            currentFontSize = Math.max(12, Math.min(32, currentFontSize + delta));
            document.getElementById('markdown-content').style.fontSize = `${currentFontSize}px`;
            document.getElementById('font-size-display').textContent = `${currentFontSize}px`;
        }

        // é‡ç½®å­—å·
        function resetFontSize() {
            currentFontSize = 18;
            document.getElementById('markdown-content').style.fontSize = '18px';
            document.getElementById('font-size-display').textContent = '18px';
        }

        // æ›´æ–°ç»Ÿè®¡
        function updateStats(count = null) {
            const total = count !== null ? count : peopleData.length;
            document.getElementById('stats-info').textContent = `å…± ${total} äºº`;
        }
    </script>
</body>
</html>
